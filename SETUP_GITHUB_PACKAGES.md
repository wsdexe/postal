# üö® –í–ê–ñ–ù–û: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤

## –ü—Ä–æ–±–ª–µ–º–∞

Workflow –ø–æ–ª—É—á–∞–µ—Ç –æ—à–∏–±–∫—É:
```
ERROR: failed to push ghcr.io/wsdexe/postal:main: denied: permission_denied: write_package
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ GitHub Actions –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ GitHub Packages.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –í–´–ü–û–õ–ù–ò–¢–ï –≠–¢–ò –®–ê–ì–ò)

### –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç–µ –ø—Ä–∞–≤–∞ –∑–∞–ø–∏—Å–∏ –¥–ª—è Workflows

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ GitHub
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** (‚öôÔ∏è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
3. –í –ª–µ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **Actions** ‚Üí **General**
4. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ —Å–µ–∫—Ü–∏–∏ **"Workflow permissions"**
5. –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é: ‚úÖ **"Read and write permissions"**
6. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∫–ª—é—á–µ–Ω–∞ –≥–∞–ª–æ—á–∫–∞: ‚úÖ **"Allow GitHub Actions to create and approve pull requests"**
7. –ù–∞–∂–º–∏—Ç–µ **Save**

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ workflow

–ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π failed workflow run
3. –ù–∞–∂–º–∏—Ç–µ **Re-run all jobs**

–ò–õ–ò

–ü—Ä–æ—Å—Ç–æ —Å–¥–µ–ª–∞–π—Ç–µ –Ω–æ–≤—ã–π push –≤ main –≤–µ—Ç–∫—É:
```bash
git commit --allow-empty -m "test: trigger workflow"
git push origin main
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è workflow:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –í –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ –Ω–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é **"Packages"**
3. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ø–∞–∫–µ—Ç **postal** üì¶

–ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞–ø—Ä—è–º—É—é:
```
https://github.com/wsdexe/postal/pkgs/container/postal
```

## –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é GitHub Actions –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ —á—Ç–µ–Ω–∏–µ. –î–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ Docker –æ–±—Ä–∞–∑–æ–≤ –≤ GitHub Container Registry –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ Packages.

–í workflow —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
```yaml
permissions:
  contents: read
  packages: write  # ‚Üê —ç—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
```

–ù–æ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤–∫–ª—é—á–µ–Ω—ã **"Read and write permissions"** –¥–ª—è Actions.

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –ø–µ—Ä–≤–æ–µ –Ω–µ –ø–æ–º–æ–≥–ª–æ)

–ï—Å–ª–∏ —É –≤–∞—Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è GitHub (–∞ –Ω–µ –ª–∏—á–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç), –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–∫–∂–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ **–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏** (–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è!)
2. **Settings** ‚Üí **Actions** ‚Üí **General**
3. –ù–∞–π–¥–∏—Ç–µ **"Workflow permissions"**
4. –í—ã–±–µ—Ä–∏—Ç–µ **"Read and write permissions"**
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

–ó–∞—Ç–µ–º –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –®–∞–≥ 1.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

–ü–æ—Å–ª–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ª–æ–≥–∞—Ö workflow –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
‚úì Image was pushed successfully!
Digest: sha256:abc123...
```

–í–º–µ—Å—Ç–æ:
```
‚úó ERROR: denied: permission_denied: write_package
```

---

**‚ùó –ë–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –®–∞–≥–∞ 1 –ø–∞–∫–µ—Ç—ã –ù–ï –ë–£–î–£–¢ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å—Å—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–∫–µ–Ω–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫!**
